import{ai as r,x as s,aE as i,L as t,aa as a,v as p}from"./chunks/framework.DNV5qdj1.js";const l="/assets/run-cmd.srdpQM_6.png",d="/assets/run-python-version.DD4IpXRj.png",c="/assets/miniconda-install.BiNhio40.png",h="/assets/python-install.D63CxHMB.png",m="/assets/wps-pluginfile-list.60xQeEKh.png",P="/assets/wps-warn1.IzjfZXl5.png",g="/assets/wps-warn2.DLyQGO3s.png",u="data:image/png;base64,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",w="/assets/wps-success.C--IbKnF.png",W="/assets/wps-plugin-ui-buttons.J2woh0G8.png",f="/assets/wps-plugin-ui.C-dJZnzZ.png",y="/assets/wps-vba-plugin-install-path.CmrLkXqB.png",A="/assets/WPS_Problems.CI-X1HPc.png",z="/assets/WPS_Problems-1.CmGFpMaF.png",b="/assets/WPS_Problems-2.DcGoWO96.png",O=JSON.parse('{"title":"在 WPS 中插入参考文献","description":"","frontmatter":{"title":"在 WPS 中插入参考文献","icon":"file-word","date":"2023-09-22T20:36:31.000Z"},"headers":[],"relativePath":"user-guide/wps-plugin.md","filePath":"wiki/user-guide/wps-plugin.md"}'),S={name:"user-guide/wps-plugin.md"};function x(k,o,Z,_,v,q){const e=a("NolebaseGitContributors"),n=a("NolebaseGitChangelog");return p(),s("div",null,[o[0]||(o[0]=i('<h1 id="在-wps-中插入参考文献" tabindex="-1">在 WPS 中插入参考文献 <a class="header-anchor" href="#在-wps-中插入参考文献" aria-label="Permalink to &quot;在 WPS 中插入参考文献&quot;">​</a></h1><p>在 WPS 中使用插件参考文献，目前有两种方法</p><ul><li>使用 VBA，借用 Word 的插件</li><li>使用 WPS JavaScript API 制作的插件</li></ul><p>使用 WPS 的 VBA 插件插入参考这篇：<a href="https://zhuanlan.zhihu.com/p/579975093" target="_blank" rel="noreferrer">完美在 WPS 中使用 Zotero 的方法</a>，该方法这个方法需要依赖 WPS 的 VBA 环境，需要升级到某些付费版本才行（当然也有破解版）。</p><p>下面是使用 WPS 原生 JavaScript API 插件的教程。</p><div class="tip custom-block"><p class="custom-block-title">macOS 系统上的 WPS 用户暂时无法使用</p><p>插件是利用 WPS 提供的 JavaScript API 从 Zotero 获取引文信息，并写入到 WPS 文档中。目前插件可以在<strong>Windows 和 Linux 系统</strong>下使用，因 WPS 的接口暂时不支持 macOS 系统，所以<strong>使用苹果电脑的同学暂时用不上这个插件</strong>。</p><p>插件地址为 <a href="https://github.com/tankwyn/WPS-Zotero" target="_blank" rel="noreferrer">https://github.com/tankwyn/WPS-Zotero</a></p></div><h2 id="_1-安装插件" tabindex="-1">1. 安装插件 <a class="header-anchor" href="#_1-安装插件" aria-label="Permalink to &quot;1. 安装插件&quot;">​</a></h2><p>因为 WPS 接口的一些限制，本插件的使用还需要使用到<strong>Python3</strong>，Linux 系统内一般默认安装了 Python3， 使用 Windows 的同学，需要提前安装好 Python3。使用 Windows 的同学从下面的 <code>1.1 Windows 下 Python3 环境的安装</code> 部分开始，使用 Linux 的同学可直接跳过这部分，看后面的安装部分就行。</p><h3 id="_1-1-windows-下-python3-环境的安装" tabindex="-1">1.1 Windows 下 Python3 环境的安装 <a class="header-anchor" href="#_1-1-windows-下-python3-环境的安装" aria-label="Permalink to &quot;1.1 Windows 下 Python3 环境的安装&quot;">​</a></h3><p>可能有一些同学的电脑里已经安装 Python3，可以按 <code>WIN + R</code>，在弹出的窗口输入 <code>cmd</code></p><p><img src="'+l+'" alt="运行CMD" loading="lazy"></p><p>点击确认后，再出现的小黑屏上输入 <code>python --version</code></p><p><img src="'+d+'" alt="查看Python版本" loading="lazy"></p><p>注意看，只要出现 <code>Python 3.xx.xx</code>，就说明 Python3 已经正确安装，直接进入下一步。如果出现其他的，说明 Python3 未正确安装，请按下面的步骤进行安装。</p><p>下载 Python3 安装包，<a href="https://www.python.org/ftp/python/3.11.5/python-3.11.5-amd64.exe" target="_blank" rel="noreferrer">64 位下载地址</a>，<a href="https://www.python.org/ftp/python/3.11.5/python-3.11.5.exe" target="_blank" rel="noreferrer">32 位下载地址</a>，不知道自己电脑是几位的，就选 64 位。如果上面两个链接下载太慢 (不开代理 ，官网下载速度慢已经 10 多年了)，可试试安装 <a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/miniconda/Miniconda3-py39_23.5.2-0-Windows-x86_64.exe" target="_blank" rel="noreferrer">miniconda</a>。</p><p>这里以 miniconda 示例，安装时默认设置，除了下面截图的设置，要记得打勾，把 Python 添加到环境变量里</p><p><img src="'+c+'" alt="安装miniconda" loading="lazy"></p><p>安装了官网 Python 的同学，需要手动将 Python 添加到环境变量里</p><p><img src="'+h+'" alt="安装Python" loading="lazy"></p><p>安装成功后，在小黑屏运行 <code>python --version</code>，出现 <code>Python 3.xx.xx</code> 说明安装成功。</p><h3 id="_1-2-安装-wps-插件" tabindex="-1">1.2 安装 WPS 插件 <a class="header-anchor" href="#_1-2-安装-wps-插件" aria-label="Permalink to &quot;1.2 安装 WPS 插件&quot;">​</a></h3><p>安装过程非常简单，作者已经帮我们处理好了，只需要一个脚本即可。如果你可流畅访问 GitHub，可直接到 <a href="https://github.com/tankwyn/WPS-Zotero" target="_blank" rel="noreferrer">https://github.com/tankwyn/WPS-Zotero</a> 下载，如果访问困难，可到这个 <a href="https://ftp.linxingzhong.top/WPS-Zotero.tar.gz" target="_blank" rel="noreferrer">镜像源</a> 下载</p><p>将下载后的压缩包解压后，看到的文件如下</p><p><img src="'+m+'" alt="解压后的文件列表" loading="lazy"></p><h4 id="windows-系统" tabindex="-1">Windows 系统 <a class="header-anchor" href="#windows-系统" aria-label="Permalink to &quot;Windows 系统&quot;">​</a></h4><p>Windows 系统直接双击 <code>windows安装与卸载.bat</code> 安装文件，你可能会遇到下面的警告提示</p><p><img src="'+P+'" alt="点击更多信息" loading="lazy"></p><p><img src="'+g+'" alt="点击仍要运行" loading="lazy"></p><p>运行后出现的提示窗口，输入 <code>1</code>，并按确认，进行安装</p><p><img src="'+u+'" alt="选择1" loading="lazy"></p><p>安装成功的提示</p><p><img src="'+w+'" alt="安装成功" loading="lazy"></p><h4 id="linux-系统" tabindex="-1">Linux 系统 <a class="header-anchor" href="#linux-系统" aria-label="Permalink to &quot;Linux 系统&quot;">​</a></h4><p>直接打开 terminal，输入 <code>python3 install.py</code> 进行安装</p><h2 id="_2-插件使用" tabindex="-1">2. 插件使用 <a class="header-anchor" href="#_2-插件使用" aria-label="Permalink to &quot;2. 插件使用&quot;">​</a></h2><p>WPS 插件的按钮与 Word 插件类似</p><ul><li>Add/Edit Citation，添加引用文献</li><li>Add/Edit Refs，添加参考文献列表</li><li>Refresh，刷新文档引用文献信息</li><li>Preferences，打开 Zotero 引用设置窗口</li><li>Add Note，添加 Zotero 笔记</li><li>Unlink，取消链接引注，通过删除域代码来取消文档中 Zotero 引文的链接。这可以防止引文和书目的任何进一步自动更新。请注意，<strong>删除域代码是不可逆的</strong>，通常只能在文档的最终副本中完成</li><li>Export，导出其他文本编辑器兼容的文本格式</li><li>About，插件相关信息</li></ul><p><img src="'+W+'" alt="WPS插件UI按钮" loading="lazy"></p><p>具体的操作过程，请参考 <a href="./ms-word-plugin">在 Word 中插入参考文献</a></p><h2 id="_3-如何卸载-wps-安装的旧版-zotero-扩展" tabindex="-1">3. 如何卸载 WPS 安装的旧版 Zotero 扩展 <a class="header-anchor" href="#_3-如何卸载-wps-安装的旧版-zotero-扩展" aria-label="Permalink to &quot;3. 如何卸载 WPS 安装的旧版 Zotero 扩展&quot;">​</a></h2><p>如果你之前安装把 Word 里的 Zotero 插件强行安装到 WPS，那样出现多个的 Zotero 选项</p><p><img src="'+f+'" alt="多个Zotero选择" loading="lazy"></p><p>先打开 <code>C:\\Users\\你的用户名\\AppData\\Roaming\\kingsoft\\wps</code> 目录 (注意用户名换成你自己的)，找到 <code>startup</code> 目录，删掉里面的 <code>zotero.dotm</code> 文件，这个文件是直接从 Zotero 的 Word 插件里复制到 WPS 里，需要 WPS 有 VBA 环境，现在已经不需要了，可以删掉。</p><p><img src="'+y+'" alt="WPS插件安装路径" loading="lazy"></p><h2 id="_4-可能遇到的问题" tabindex="-1">4. 可能遇到的问题 <a class="header-anchor" href="#_4-可能遇到的问题" aria-label="Permalink to &quot;4. 可能遇到的问题&quot;">​</a></h2><h3 id="_4-1-不会自动出现" tabindex="-1">4.1 不会自动出现 <a class="header-anchor" href="#_4-1-不会自动出现" aria-label="Permalink to &quot;4.1 不会自动出现&quot;">​</a></h3><p>使用中可能点击按钮后，Zotero 的窗口不会自动出现，可以手动点击一下任务栏中的 Zotero 图标，让 Zotero 的窗口跳到最前。</p><h3 id="_4-2-插件安装后-wps-内不显示" tabindex="-1">4.2 插件安装后 WPS 内不显示 <a class="header-anchor" href="#_4-2-插件安装后-wps-内不显示" aria-label="Permalink to &quot;4.2 插件安装后 WPS 内不显示&quot;">​</a></h3><p>该部分教程来自与<a href="https://p.kdocs.cn/s/ZPIJCBAABE" target="_blank" rel="noreferrer">官方文档</a></p><p>若安装 Zotero 插件后，打开 WPS 不显示，请按照以下步骤操作：</p><ol><li>关闭 WPS。</li><li>打开 Zotero 的安装包路径 <code>C:\\Program Files (x86)\\Zotero\\extensions\\zoteroWinWordIntegration@zotero.org\\install</code></li><li>找到文件 Zotero.dotm，复制 <img src="'+A+'" alt="image" loading="lazy"></li><li>将第 3 步复制的文件粘贴到以下目录路径 C:\\Users\\Administrator\\AppData\\Roaming\\kingsoft\\WPS\\startup <img src="'+z+'" alt="image" loading="lazy"></li><li>重启 WPS，即可看到 Zotero 插件 <img src="'+b+'" alt="image" loading="lazy"></li></ol>',51)),t(e),t(n)])}const T=r(S,[["render",x]]);export{O as __pageData,T as default};
