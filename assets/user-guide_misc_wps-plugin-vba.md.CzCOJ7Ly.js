import{_ as a}from"./chunks/zotero-addon-重新安装加载项.CPnmOvuV.js";import{ai as g,x as i,aE as e,L as t,aa as s,v as p}from"./chunks/framework.DNV5qdj1.js";const l="/assets/wps-%E6%B2%A1%E6%9C%89%E6%98%BE%E7%A4%BA%E5%8A%A0%E8%BD%BD%E9%A1%B9.CQ3pCDYn.png",c="/assets/wps-%E5%8F%8C%E5%87%BBvba%E5%AE%89%E8%A3%85%E7%A8%8B%E5%BA%8F.BWkTyt4v.png",d="/assets/wps-%E5%AE%89%E8%A3%85vba.Ddfparek.png",m="/assets/wps-%E6%89%93%E5%BC%80zotero%E6%89%80%E5%9C%A8%E4%BD%8D%E7%BD%AE.BLaiRj5Q.png",E="/assets/wps-word%E6%A8%A1%E6%9D%BF%E4%BD%8D%E7%BD%AE.D6SjiJf7.png",B="/assets/wps-%E6%A8%A1%E6%9D%BF%E6%96%87%E4%BB%B6.CcGuD3o3.png",A="/assets/wps-%E6%89%93%E5%BC%80wps%E7%A8%8B%E5%BA%8F%E7%9B%AE%E5%BD%95.BbXBRpZV.png",h="/assets/wps-%E9%80%89%E6%8B%A9wps%E7%A8%8B%E5%BA%8F%E7%9B%AE%E5%BD%95%E7%89%88%E6%9C%AC.CGKmv4OP.png",u="/assets/wps-%E7%A8%8B%E5%BA%8F%E7%9B%AE%E5%BD%95-office6.Db0V9Slt.png",b="/assets/wps-startup%E7%9B%AE%E5%BD%95.DOxwKSaW.png",_="/assets/wps-zotero%E5%9C%A8%E6%9B%B4%E6%96%B0%E6%96%87%E6%A1%A3%E6%97%B6%E5%87%BA%E9%94%99.BnhbsKOi.png",f="/assets/word-%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE%E8%A1%A8.CHpS4E2B.png",k="/assets/wps-%E9%80%89%E6%8B%A9%E5%8A%A0%E8%BD%BD%E9%A1%B9%E6%A8%A1%E6%9D%BF.CjpQ5_do.png",W="/assets/wps-%E5%A4%8D%E5%88%B6%E5%9C%B0%E5%9D%80.BPGpBZk6.png",w="/assets/wps-%E4%BF%9D%E5%AD%98%E6%96%87%E4%BB%B6.fif3pbEu.png",P="/assets/wps-%E4%BF%9D%E5%AD%98%E6%A8%A1%E6%9D%BF%E4%BD%8D%E7%BD%AE.DtAnq5q2.png",D="/assets/wps-%E6%89%93%E5%BC%80%E6%A8%A1%E6%9D%BF%E6%96%87%E4%BB%B6.DRZumBm0.png",S="/assets/wps-%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7.D7QRkBkR.png",v="/assets/wps-%E4%BF%AE%E6%94%B9%E6%A8%A1%E6%9D%BF%E5%8F%82%E6%95%B0.Bqb7IHF8.png",C="/assets/wps-%E6%B7%BB%E5%8A%A0%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7.Czyjmezh.png",Z="/assets/wps-%E4%BF%9D%E5%AD%98%E6%A8%A1%E6%9D%BF.D7nTAd2O.png",z="/assets/wps-%E5%9B%BE%E6%A0%87%E4%B8%BA%E9%97%AE%E5%8F%B7.DF5YKksz.png",q="/assets/wps-%E4%B8%8D%E5%90%8C%E7%9A%84%E6%A8%A1%E6%9D%BF.C9lJGMTL.png",y="/assets/wps-%E4%B8%8D%E5%90%8C%E5%9B%BE%E6%A0%87.fMY57taO.png",R="/assets/wps-%E9%87%8D%E5%A4%8D%E7%9A%84%E9%80%89%E9%A1%B9%E5%8D%A1.BMbSY3HM.png",F="/assets/wps-%E7%A6%81%E7%94%A8%E5%8E%9F%E6%A8%A1%E6%9D%BF.C0KrQf79.png",x="/assets/wps-%E7%A1%AE%E5%AE%9A%E7%BC%96%E8%BE%91.Cj_ZIEaA.png",I=JSON.parse('{"title":"通过 VBA 在 WPS 中使用 Word 插件","description":"","frontmatter":{"title":"通过 VBA 在 WPS 中使用 Word 插件","authors":["winding","不秃燃的小老弟"],"date":"2022-11-08T11:38:09.000Z","updated":"2023-10-04T12:06:44.000Z"},"headers":[],"relativePath":"user-guide/misc/wps-plugin-vba.md","filePath":"wiki/user-guide/misc/wps-plugin-vba.md"}'),V={name:"user-guide/misc/wps-plugin-vba.md"};function O(N,o,U,M,j,G){const r=s("NolebaseGitContributors"),n=s("NolebaseGitChangelog");return p(),i("div",null,[o[0]||(o[0]=e('<h1 id="通过-vba-在-wps-中使用-word-插件" tabindex="-1">通过 VBA 在 WPS 中使用 Word 插件 <a class="header-anchor" href="#通过-vba-在-wps-中使用-word-插件" aria-label="Permalink to &quot;通过 VBA 在 WPS 中使用 Word 插件&quot;">​</a></h1><h2 id="前言-很重要哦" tabindex="-1">前言（很重要哦！） <a class="header-anchor" href="#前言-很重要哦" aria-label="Permalink to &quot;前言（很重要哦！）&quot;">​</a></h2><div class="info custom-block"><p class="custom-block-title">信息</p><p><strong>Zotero Word 插件在 WPS 的使用操作与 Office Word 类似，因此不再展开说明，点击下方蓝字可查看 📝</strong><a href="./../ms-word-plugin"><strong>在 Word 中插入引文</strong></a></p></div><blockquote><p><strong>🔊🔊🔊 必看！！！</strong>：当新建一个空白的 Word 文档用 WPS 打开撰写论文等情况时：一定要先用 WPS 里的 Zotero Word 加载项插入几个文献，再点击<strong>Add/Edit Citation 等这 6 个按钮</strong>，尤其是一定要多次点击<strong>Refresh</strong>和<strong>Unlink Citations</strong>按钮，检查是否正常使用！！！（无法正常使用请见本文档 <strong>四、Refresh/Unlink Citations 莫名失效</strong>）</p></blockquote><div class="warning custom-block"><p class="custom-block-title">警告</p><p><strong>以下是 WPS 的 Zotero Word 加载项的常见问题及解决方法，均以 Window 系统为例演示 📝：</strong></p></div><h2 id="一、没有显示-zotero-加载项" tabindex="-1">一、没有显示 Zotero 加载项 <a class="header-anchor" href="#一、没有显示-zotero-加载项" aria-label="Permalink to &quot;一、没有显示 Zotero 加载项&quot;">​</a></h2><p><img src="'+l+'" alt="image.png" loading="lazy"></p><div class="info custom-block"><p class="custom-block-title">信息</p><p>如上图所示，WPS 的文档界面不显示 Zotero 加载项。<strong>解决办法如下</strong>：</p></div><h3 id="_1、检查-microsoft-word-加载项" tabindex="-1">1、检查 Microsoft Word 加载项 <a class="header-anchor" href="#_1、检查-microsoft-word-加载项" aria-label="Permalink to &quot;1、检查 Microsoft Word 加载项&quot;">​</a></h3><p>检查 Zotero 是否已正常安装好<strong>Microsoft Word 加载项</strong>。安装此加载项的步骤，详见 Zotero 百科全书的 <a href="./../faqs/word-addon">「引文|插件」Word 加载项相关问题</a>（点击左侧蓝字自查）</p><p><img src="'+a+'" alt="重新安装加载项" loading="lazy"></p><h3 id="_2、wps-vba-插件的安装" tabindex="-1">2、WPS.VBA 插件的安装 <a class="header-anchor" href="#_2、wps-vba-插件的安装" aria-label="Permalink to &quot;2、WPS.VBA 插件的安装&quot;">​</a></h3><p>若 WPS 为<strong>个人版</strong>，需额外安装 <a href="https://pan.baidu.com/s/1y-cjisA6Lxbnw3r3g_jmKA?pwd=moyu" target="_blank" rel="noreferrer"><strong>VBA 插件</strong></a>（点击左侧蓝字获取插件）</p><div class="warning custom-block"><p class="custom-block-title">警告</p><p>WPS 专业版等版本一般已自带 VBA 宏功能，Zotero 加载项如有使用问题，也可选择安装 VBA 插件。</p></div><p>1）将 WPS.VBA 安装程序<strong>下载并保存</strong>到电脑，确保 WPS 程序是 <strong>未运行</strong>状态。</p><p><img src="'+c+'" alt="image.png" loading="lazy"></p><p>2）<strong>双击</strong>打开 WPS. VBA 安装程序，依次单击「<strong>Next</strong>」，最后单击「<strong>Finish</strong>」。用 WPS 打开任意一个 Word 文档，检查是否正常显示 Zotero 加载项。</p><p><img src="'+d+'" alt="image.png" loading="lazy"></p><div class="warning custom-block"><p class="custom-block-title">警告</p><p>若 WPS. VBA 安装后，仍未显示 Zotero 加载项，或需将「<strong>宏安全性</strong>」设成低（但不建议）。除此外可见下方<strong>3、补充 Zotero. dotm 文件</strong></p></div><h3 id="_3、补充-zotero-dotm-文件" tabindex="-1">3、补充 Zotero.dotm 文件 <a class="header-anchor" href="#_3、补充-zotero-dotm-文件" aria-label="Permalink to &quot;3、补充 Zotero.dotm 文件&quot;">​</a></h3><p>1）在 Zotero 图标处<strong>右键单击</strong>，单击「<strong>打开文件所在的位置</strong>」打开 Zotero 安装路径</p><p><img src="'+m+'" alt="image.png" loading="lazy"></p><p>2）依次双击打开「<strong>extensions</strong>」-「<strong><a href="mailto:zoteroWinWordIntegration@zotero.org" target="_blank" rel="noreferrer">zoteroWinWordIntegration@zotero.org</a>」-「install</strong>」文件夹，复制 <strong>Zotero.dotm</strong> 文件。</p><p><img src="'+E+'" alt="image.png" loading="lazy"></p><p><img src="'+B+'" alt="image.png" loading="lazy"></p><div class="warning custom-block"><p class="custom-block-title">警告</p><p>如果上图文件夹位置没有 Zotero.dotm，可点击右侧蓝字获取 <a href="https://pan.baidu.com/s/1EMfR5KRi8Mxxn9Wa7UR7Ag?pwd=moyu" target="_blank" rel="noreferrer"><strong>Zotero.dotm</strong></a></p></div><p>3）在 WPS 图标处<strong>右键单击</strong>，单击「<strong>打开文件所在的位置</strong>」打开 WPS 安装路径。</p><p><img src="'+A+'" alt="image.png" loading="lazy"></p><div class="warning custom-block"><p class="custom-block-title">警告</p><p>以上前提是确保 WPS 已关闭，不在运行中！！！</p></div><p>4）找到并打开<strong>版本最新</strong>的文件夹（即<strong>数字最大</strong>），再依次打开「<strong>office6</strong>」-「<strong>startup</strong>」</p><p><img src="'+h+'" alt="image.png" loading="lazy"></p><p><img src="'+u+'" alt="image.png" loading="lazy"></p><p>5）在 WPS 的「<strong>startup</strong>」启动项文件夹内，粘贴 <strong>Zotero.dotm</strong> 文件。再次用 WPS 打开任一 Word 文档，检查 WPS 是否已显示 Zotero 加载项。</p><p><img src="'+b+'" alt="image.png" loading="lazy"></p><h2 id="二、zotero-加载项出现弹窗报错" tabindex="-1">二、Zotero 加载项出现弹窗报错 <a class="header-anchor" href="#二、zotero-加载项出现弹窗报错" aria-label="Permalink to &quot;二、Zotero 加载项出现弹窗报错&quot;">​</a></h2><p><img src="'+_+'" alt="image.png" loading="lazy"></p><div class="info custom-block"><p class="custom-block-title">信息</p><p>如上图所示，在 WPS 使用 Zotero 加载项的各个按钮时，会出现弹窗警告。<strong>解决方法如下</strong>：</p></div><h3 id="_1、解决方法一" tabindex="-1">1、解决方法一 <a class="header-anchor" href="#_1、解决方法一" aria-label="Permalink to &quot;1、解决方法一&quot;">​</a></h3><p>新建一个 Word 文档，先用 <strong>Office</strong>打开此文档，用 Zotero 加载项 <strong>插入一篇文献</strong>后，保存此文档即可。</p><p><img src="'+f+'" alt="image.png" loading="lazy"></p><div class="warning custom-block"><p class="custom-block-title">警告</p><p>设置较简单，仅适用于<strong>同时安装 Office 和 WPS</strong>。以后再使用时，可能还会报错。</p><p>如仍报错：可能是将光标置于插入引文 Citaion 和参考文献 References 位置的<strong>前后或内部</strong></p><p>解决方法：将光标定位在远离上述位置如正文文字处</p></div><h3 id="_2、解决方法二" tabindex="-1">2、解决方法二 <a class="header-anchor" href="#_2、解决方法二" aria-label="Permalink to &quot;2、解决方法二&quot;">​</a></h3><p>1）单击「<strong>开发者工具</strong>」-「<strong>加载项</strong>」，弹出的对话框单击「<strong>选用</strong>」。</p><p><img src="'+k+'" alt="image.png" loading="lazy"></p><div class="warning custom-block"><p class="custom-block-title">警告</p><p>设置较复杂，适用于 <strong>同时装有 Office 和 WPS</strong>或 <strong>只装有 WPS</strong></p></div><div class="warning custom-block"><p class="custom-block-title">警告</p><p>若「<strong>开发工具</strong>」选项卡的内容为灰色，即无法点击操作。</p><p><strong>解决方法</strong>：安装 WPS. VBA 插件（详见本文档 <strong>WPS. VBA 插件的安装</strong>）</p><p>或需升级更新 WPS 版本，以及可能需要安装使用 WPS 专业版等版本。</p></div><p>2）弹出对话框，双击进入上方地址栏并复制<strong>地址</strong>，或地址栏处右键单击，再单击「<strong>将地址复制为文本</strong>」。复制好地址后，即可关闭当前窗口。</p><p><img src="'+W+'" alt="image.png" loading="lazy"></p><p>3）单击「<strong>文件</strong>」选项卡，再单击「<strong>打开</strong>」。将 <strong>地址</strong> 粘贴至「<strong>文件名</strong>」，「<strong>文件类型</strong>」选择 <strong>所有文件</strong>，然后单击「<strong>打开</strong>」。</p><p><img src="'+w+'" alt="image.png" loading="lazy"></p><p><img src="'+P+'" alt="image.png" loading="lazy"></p><p>4）选中 <strong>Normal.dotm</strong> 文件，单击「<strong>打开</strong>」，随之打开名为 <strong>Normal.dotm</strong> 文档。</p><p><img src="'+D+'" alt="image.png" loading="lazy"></p><p>5）在 <strong>Normal.dotm</strong> 文档内，依次单击「<strong>文件</strong>」-「<strong>文档加密</strong>」-「<strong>属性</strong>」</p><p><img src="'+S+'" alt="image.png" loading="lazy"></p><p>6）在 <strong>Normal.dotm</strong> 属性对话框，切换到「<strong>自定义</strong>」窗口，「<strong>名称</strong>」和「<strong>取值</strong>」分别输入 <strong>ZOTERO_PREF_1</strong> 和 <strong>1</strong> ，点击「<strong>添加</strong>」。同理，再添加上 <strong>ZOTERO_PREF_2</strong> 和 <strong>1</strong> ，最后点击「<strong>确定</strong>」。</p><p><img src="'+v+'" alt="image.png" loading="lazy"></p><p>这一步完成的效果如下：</p><p><img src="'+C+'" alt="image.png" loading="lazy"></p><p>7）左上角单击「<strong>保存</strong>」图标或快捷键 <strong>Ctrl+S</strong> 保存 <strong>Normal.dotm</strong> 文档。重新用 WPS 打开一个 Word 文档检查是否不再出现报错窗口。</p><p><img src="'+Z+'" alt="image.png" loading="lazy"></p><div class="warning custom-block"><p class="custom-block-title">警告</p><p>如仍报错：可能是将光标置于插入引文 Citaion 和参考文献 References 位置的<strong>前后或内部</strong></p><p>解决方法：将光标定位在远离上述位置如正文文字处</p></div><h2 id="三、refresh-unlink-citations-问号图标" tabindex="-1"><strong>三、Refresh/Unlink Citations 问号图标</strong> <a class="header-anchor" href="#三、refresh-unlink-citations-问号图标" aria-label="Permalink to &quot;**三、Refresh/Unlink Citations 问号图标**&quot;">​</a></h2><p><img src="'+z+'" alt="image.png" loading="lazy"></p><div class="info custom-block"><p class="custom-block-title">信息</p><p>如上图所示，<strong>Refresh</strong>和 <strong>Unlink Citations</strong>图标显示为问号，<strong>解决办法如下</strong>：</p></div><h3 id="_1、直接安装美化后的图标文件" tabindex="-1">1、直接安装美化后的图标文件 <a class="header-anchor" href="#_1、直接安装美化后的图标文件" aria-label="Permalink to &quot;1、直接安装美化后的图标文件&quot;">​</a></h3><p>1）我已创建 5 种 <a href="https://pan.baidu.com/s/1BXjo-ZOT971qlsY-zboIdA?pwd=moyu" target="_blank" rel="noreferrer">Refresh 和 Unlink Citations 图标</a>（任选其一），可直接安装使用。点击上方蓝字即可获取，首先将其<strong>下载并保存</strong>到电脑（如下图所示）。</p><p><img src="'+q+'" alt="image.png" loading="lazy"></p><div class="warning custom-block"><p class="custom-block-title">警告</p><p>只需选择使用一个自己喜爱的图标文件或可自己编辑设计图标。</p></div><p>下方是 5 个已编辑好的 <strong>Refresh</strong>和 <strong>Unlink Citations</strong>图标的图片展示。</p><p><img src="'+y+'" alt="image.png" loading="lazy"></p><p>2）将上述<strong>任一 Zotero</strong>文件，粘贴至 WPS 的<strong>启动项文件夹</strong>内（详见本文档的 <strong>补充 Zotero.dotm 文件</strong>）</p><p>3）用 WPS 打开任一 Word 文档，但是会显示有 2 个 Zotero 加载项。</p><p><img src="'+R+'" alt="image.png" loading="lazy"></p><div class="warning custom-block"><p class="custom-block-title">警告</p><p>因为没更换 Zotero 安装路径的 Zotero.dotm，且 Office Word 的启动项文件夹未放置 Zotero.dotm。</p></div><div class="info custom-block"><p class="custom-block-title">信息</p><p>这样做的考虑是：保持 Office Word 的 Refresh 和 Unlink Citations 图标不变动，同时保留原有的 Zotero. dotm，以备不时之需。当然也可自己按喜好设置更换。</p></div><h4 id="只保留-1-个-zotero-加载项" tabindex="-1">只保留 1 个 Zotero 加载项 <a class="header-anchor" href="#只保留-1-个-zotero-加载项" aria-label="Permalink to &quot;只保留 1 个 Zotero 加载项&quot;">​</a></h4><p>1）依次单击「<strong>开发者工具</strong>」-「<strong>加载项</strong>」。 单击选中 <strong>Zotero.dotm</strong>，单击「<strong>禁用</strong>」。</p><p><img src="'+F+'" alt="image.png" loading="lazy"></p><p>2）<strong>Zotero.dotm</strong> 前面方框，此刻已更改成 <strong>取消勾选</strong>，点击「<strong>确定</strong>」即可。</p><p><img src="'+x+'" alt="image.png" loading="lazy"></p><h2 id="四、refresh-unlink-citations-莫名失效" tabindex="-1">四、Refresh/Unlink Citations 莫名失效 <a class="header-anchor" href="#四、refresh-unlink-citations-莫名失效" aria-label="Permalink to &quot;四、Refresh/Unlink Citations 莫名失效&quot;">​</a></h2><p>有时新建 Word 文档，用 WPS 打开后，无故出现点击 Refresh 和 Unlink Citations 功能失效（即无响应或莫名删掉引文 Citation）。</p><p><strong>解决方法</strong>：</p><p>1）不要将光标置于插入引文 Citaion 和参考文献 References 的位置（即将光标定位在远离上述位置如正文文字处，再点击 Refresh 按钮）</p><p>2）重启 WPS，或新建一个 Word 文档，再用 WPS 打开。或必要时重启电脑即可正常使用。</p><blockquote><p><strong>🔊🔊🔊 必看！！！</strong>：当新建一个空白的 Word 文档用 WPS 打开撰写论文等情况时：一定要先用 WPS 里的 Zotero Word 加载项插入几个文献，再点击<strong>Add/Edit Citation 等这 6 个按钮</strong>，尤其是一定要多次点击<strong>Refresh</strong>和<strong>Unlink Citations</strong>按钮，检查是否正常使用！！！</p></blockquote><h2 id="致谢" tabindex="-1">致谢 <a class="header-anchor" href="#致谢" aria-label="Permalink to &quot;致谢&quot;">​</a></h2><div class="info custom-block"><p class="custom-block-title">信息</p><p>👍 到这里，在 WPS 中使用 Zotero Word 加载项的使用已接近尾声。在此由衷地感谢来自 b 站、知乎、CSDN 等网站的大神们分享的有关 WPS 的 Zotero Word 加载项使用的宝贵经验！！！</p></div>',89)),t(r),t(n)])}const Q=g(V,[["render",O]]);export{I as __pageData,Q as default};
